<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>mmt payment metadata app</title>

    <link rel="stylesheet" href="./assets/css/bootstrap.min.css">
    <link rel="stylesheet" href="./assets/css/jquery-ui.min.css">
    <style>
/* TODO: put this somewhere else */
.invisible {
  display: none;
}
      .incompleteUnfilled {
        display: none;
      }
      .paymentsUnfilled {
        display: none;
      }
      .addressesUnfilled {
        display: none;
      }
      .requestsUnfilled {
        display: none;
      }
      #payTo {
        width: 400px;
      }
    </style>

    <!-- Insert this line above script imports  -->
    <script>
      delete module.exports
    </script>

    <script src="./assets/scripts/jquery-3.3.1.min.js"></script>
    <script src="./assets/scripts/jquery-ui.min.js"></script>

    <!-- normal script imports etc  -->

    <script src="../src/mmt-metadata.js"></script>

    <script>
      // TODO: put this somewhere else 
      $(function() {
        $( "#tabs" ).tabs();
      });

      function backToTables() {
        $('#transactionDetails').attr("class","invisible")
        $('#transactionTables').attr("class","visible")
      }
    </script>
  </head>
  <body>
    <div id="root">
      <div class = "container">
        <h1>mmt payment metadata app</h1>
        <div id="notifications"></div>
        <div id="walletInfo">
          <b><span id="walletName"></span></b> -
          <span id="requiredCosigners"></span> of <span id="numberCosigners"></span> multisig. -
          Confirmed balance: <span class="balance"></span> BTC
        </div>
        <div id="tabs">
          <ul>
            <li><a href="#history">Transactions</a></li>
            <li><a href="#send">Send</a></li>
            <li><a href="#recieve">Recieve</a></li>
            <li><a href="#addresses">Addresses</a></li>
            <li><a href="#coins">Coins</a></li>
            <li><a href="#contacts">Contacts</a></li>
          </ul>

          <div id="history">
            <div id="transactionTables" class="visible">
              <h3> Incomplete transactions </h3>
              <table class = "table">
                <thead>
                  <tr>
                    <th> Date </th>
                    <th> Initiated by </th>
                    <th> Cosigners </th>
                    <th> Description and comments </th>
                    <th> Rate </th>
                    <th> Amount </th>
                    <th> Confirmations </th>
                    <th> Recipient(s) </th>
                    <th> Options </th>
                  </tr>
                </thead>
                <tbody id="incompleteTbody">
                  <tr class="incompleteUnfilled">
                    <td class="date"></td>
                    <td class="initiatedBy"></td>
                    <td class="cosigners"></td>
                    <td class="comment"></td>
                    <td class="rate"></td>
                    <td class="amount"></td>
                    <td class="recipients"></td>
                    <td class="options">
                      <button class="details">Details</button>
                    </td>
                  </tr>
                </tbody>
              </table>    
              <h3> Broadcast transactions </h3>
              <table class = "table">
                <thead>
                  <tr>
                    <th> Date </th>
                    <th> Cosigners </th>
                    <th> Description and comments </th>
                    <th> Rate </transactionComment>
                      <th> Amount </th>
                      <th> Confirmations </th>
                      <th> Recipient(s) </th>
                      <th> Options </th>
                  </tr>
                </thead>
                <tbody id="paymentsTbody">
                  <tr class="paymentsUnfilled">
                    <td class="date"></td>
                    <td class="cosigners"></td>
                    <td class="comment"></td>
                    <td class="rate"></td>
                    <td class="amount"></td>
                    <td class="confirmations"></td>
                    <td class="recipients"></td>
                    <td class="options">
                      <button class="details">Details</button>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div id="transactionDetails" class="invisible">
              <h5> Details for transaction <span id="txid"></span> </h5>
              <p> Amount <span id="transactionDetailsAmount"></span> </p>
              <p> Initiated by: <span id="initiatedBy"></span></p>
              <p> Signed by: <span id="initiatedBy"></span></p>
              <p> Outputs: <span id="outputs"></span></p>
              <p> Comments: <span id="comments"></span></p>
              <p> Add a comment: <input type="text" name="addTransactionComment" id="addTransactionComment" ></p> 
              <button id="addComment">Add comment</button>
              <button id="toTable" onclick='backToTables()'>Back to other transactions</button>
            </div>
          </div>

          <div id="send">
            <p>Balance available: <span class="balance"></span> BTC</p>
            <p>Pay to: <input type="text" name="payTo" id="payTo" ></p> 
            <p>Amount: <input type="text" name="sendAmount" id="sendAmount" ></p>
            <p>Description: <input type="text" name="sendComment" id="sendComment" ></p>
            <button id="createTransaction">Create transaction</button>
            <p><span id="sendVerifyErrors"></span></p>
          </div>

          <div id="recieve">
            <p> Recieve address: <span id="recieveAddress"></span><button id="addressToClipboard" onclick="">Copy to clipboard</button></p>
            <p> Memo <input type="text" name="memo" id="memo" oninput='' ></p>
            <p> Requested Amount (optional) <input type="text" name="requestedAmount" id="requestedAmount" oninput=''></p>
            <p> Expires: (drop down box?) </p>
            <button id="recieveMemo">Save memo to recieve address</button>
            <br><br>
            <h4> Existing requests: </h4>
            <table class = "table">
              <thead>
                <tr>
                  <th> Address </th>
                  <th> Memo </th>
                </tr>
              </thead>
              <tbody id="requestsTbody">
                <tr class="requestsUnfilled">
                  <td class="address"></td>
                  <td class="memo"></td>
                </tr>
              </tbody>
            </table>
          </div>

          <div id="addresses">

            <table class = "table">
              <thead>
                <tr>
                  <th> Address </th>
                  <th> Amount </th>
                  <th> Comments </th>
                </tr>
              </thead>
              <tbody id="addressesTbody">
                <tr class="addressesUnfilled">
                  <td class="address"></td>
                  <td class="amount"></td>
                  <td class="comments"></td>
                </tr>
              </tbody>
            </table>
          </div>

          <div id="coins">
            <p>coming soon</p>
          </div>

          <div id="contacts">
            <p>coming soon</p>
          </div>

        </div>
      </div>
    </div>
    <script>
      var Client = require('ssb-client')
      var config = require('./config')()
      var App = require('./app/')

      Client(config.keys, config, (err, server) => {
        if (err) return console.error(err)
        App(document.getElementById('root'), server)
      })
    </script>
  </body>
</html>
